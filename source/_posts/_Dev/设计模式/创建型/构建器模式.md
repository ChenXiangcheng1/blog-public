---
title: 构建器模式
date: 2023-09-19
update: 2023-09-19
tag:
categories:
  - 设计模式
  - 创建型
keywords: 设计模式,构建器模式
description: 关于设计模式中的构建器模式
top_img:
cover: 
---



# Builder Pattern

## 意图

构建者模式是一种创建型设计模式，使你能够分步创建复杂对象(有许多配置选项的对象)。该模式允许你使用相同的创建代码生成不同类型和形式的对象。

又称作建造者模式、生成器模式



## 结构

<img src="https://cdn.jsdelivr.net/gh/ChenXiangcheng1/image-hosting2/img/2023_09_19_22_32.png" alt="image-20230919223235786" style="zoom: 50%;" />

1. **生成器**(Builder) - 接口声明在所有类型生成器中通用的产品构造步骤。
2. **具体生成器**(Concrete Builders) - 提供构造过程的不同实现。具体生成器也可以构造不遵循通用接口的产品。
3. **产品**(Products) - 是最终生成的对象。由不同生成器构造的产品无需属于同一类层次结构或接口。
4. **主管**(Director) - 类定义调用构造步骤的顺序，使得可以创建和复用特定的产品配置。
   **主管类可定义创建步骤的执行顺序， 而生成器则提供这些步骤的实现。**
   严格来说，也可以不使用主管类，客户端代码可直接以特定顺序调用创建步骤，但是主管类方便复用。
5. **客户端**(Client) - 必须将某个生成器对象与主管类关联。 
   一般情况下，你只需通过主管类构造函数的参数进行一次性关联即可。此后主管类就能使用生成器对象完成后续所有的构造任务
   另一种方式客户端将生成器对象传递给主管类的一般方法，在这种情况下你在使用主管类生产产品时每次都可以使用不同的生成器



## 应用场景

* 当你希望避免使用多次重载构造函数以提供伸缩构造时，可使用构建器模式
* 当你希望使用代码创建不同形式的产品时，可使用构建器模式
* 构造组合树或其他复杂对象时，可使用构建器模式
  实现：可以暂缓创建步骤、递归运行创建步骤



## 实现方式

1. 清晰地定义通用步骤， 确保它们可以制造所有形式的产品。 否则你将无法进一步实施该模式。

2. 在基本生成器接口中声明这些步骤。

3. 为每个形式的产品创建具体生成器类， 并实现其构造步骤。

   不要忘记实现获取构造结果对象的方法。 你不能在生成器接口中声明该方法， 因为不同生成器构造的产品可能没有公共接口， 因此你就不知道该方法返回的对象类型。 但是， 如果所有产品都位于单一类层次中， 你就可以安全地在基本接口中添加获取生成对象的方法。

4. 考虑创建主管类。 它可以使用同一生成器对象来封装多种构造产品的方式。

5. 客户端代码会同时创建生成器和主管对象。 构造开始前， 客户端必须将生成器对象传递给主管对象。 通常情况下， 客户端只需调用主管类构造函数一次即可。 主管类使用生成器对象完成后续所有制造任务。 还有另一种方式， 那就是客户端可以将生成器对象直接传递给主管类的制造方法。

6. 只有在所有产品都遵循相同接口的情况下， 构造结果可以直接通过主管类获取。 否则， 客户端应当通过生成器获取构造结果。



## 识别方法

构建器模式可以通过类来识别，该类拥有一个构建方法和多个配置结果对象的方法。生成器方法通常支持方法链。



## 我的评价

缺点：该模式需要新增多个类，因此代码整体复杂程度会有所增加



## 示例1

[Javab笔记#StringBuilder和StringBuff](../../Java/类库APIs/LiteAPIs.md#StringBuilder)

StringBuilder 继承 AbstractStringBuilder(生成器提供步骤的实现) 继承 Appendable



## 示例2

SpringApplicationBuilder(生成器提供步骤的实现) 依赖 SpringApplication



## 示例3 - 使用

[Lombok笔记#@Builder](../../../Dev/java-library/Lombok1.18.28.md#使用)

